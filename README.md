# 抖音评论采集工具

一个简单易用的抖音视频评论采集工具，支持GUI界面操作，自动管理Cookie，采集评论数据并支持导出Excel格式。现已支持DeepSeek AI智能分析评论内容。

## 🌟 功能特点

- ✨ 图形化界面，简单易用
- 🔄 支持从分享链接自动提取视频ID
- 🍪 Cookie管理系统
  - 支持导入JSON格式的Cookie
  - 自动验证Cookie有效性
  - 定时检查Cookie状态（每5分钟）
  - 实时显示Cookie状态
- 📝 评论数据采集
  - 支持采集一级评论
  - 可选择是否采集评论回复
  - 采集过程实时显示进度
  - 无评论数量限制
  - 智能采集策略，自动适应不同评论量
- 💾 数据本地保存
  - 支持导出Excel格式（.xlsx）
  - 保存为CSV格式
  - 包含评论ID、内容、点赞数等信息
- 🤖 AI智能分析（新功能）
  - 接入DeepSeek AI模型
  - 自动分析评论情感倾向
  - 提取主要话题和关键词
  - 总结用户意见和建议
  - 识别热点问题和争议点
  - 提供回应策略建议

## 🆕 最新更新 (v1.2.1)

1. AI分析功能增强
   - 新增自定义提问功能
   - 支持用户针对评论内容提出特定问题
   - 优化AI分析界面布局
   - 修复默认分析功能失效问题

2. 界面优化
   - 重新设计AI分析页面布局
   - 添加自定义提问区域
   - 优化按钮状态管理
   - 改进分析结果显示

3. 用户体验改进
   - 添加更多用户提示信息
   - 优化按钮状态切换逻辑
   - 改进错误处理机制
   - 提供更多示例问题

4. Bug修复
   - 修复AI分析按钮失效问题
   - 修复数据引用错误
   - 优化状态管理逻辑
   - 改进异常处理机制

## 💻 界面说明

### Cookie管理页面
![Cookie管理页面](docs/images/cookie_management.png)

1. Cookie导入区域
   - 文本框：粘贴从浏览器导出的JSON格式Cookie
   - 导入按钮：保存Cookie到本地
   - 验证按钮：检查Cookie有效性
   - 复制按钮：复制当前Cookie到剪贴板

### 评论采集页面
![评论采集页面](docs/images/comment_collection.png)

1. 输入区域
   - 分享链接输入框：粘贴抖音视频分享链接
   - 评论回复选项：是否采集评论的回复
   - 开始采集按钮：启动采集过程
   - 保存数据按钮：将数据导出为Excel文件

2. 数据显示
   - 运行日志：显示采集过程的实时状态
   - 数据表格：展示采集到的评论数据

### AI分析页面

1. API设置区域
   - API Key输入框：输入DeepSeek API密钥
   - 验证按钮：验证API Key有效性
   - 密钥本地安全存储

2. 分析功能
   - 一键分析：自动分析评论情感、话题等
   - 自定义提问：支持用户针对性提问
   - 智能分析评论情感倾向
   - 自动提取关键话题
   - 生成分析报告
   - 提供运营建议

3. 自定义提问区域（新增）
   - 问题输入框：输入您想了解的具体问题
   - 智能分析：基于评论数据回答问题
   - 灵活查询：支持多角度分析

## 📝 使用方法

1. Cookie准备
   - 在浏览器中登录抖音网页版
   - 使用Cookie Editor等工具导出Cookie为JSON格式
   - 复制JSON格式的Cookie内容

2. Cookie导入
   - 打开软件，进入"Cookie管理"标签页
   - 将JSON格式Cookie粘贴到输入框
   - 点击"导入Cookies"按钮
   - 点击"验证Cookies"按钮确认有效性

3. 评论采集
   - 切换到"评论采集"标签页
   - 从抖音复制视频分享链接
   - 粘贴到输入框
   - 选择是否需要获取评论回复
   - 点击"开始采集"

4. 数据导出
   - 采集完成后点击"保存数据"按钮
   - 选择保存位置和文件名
   - 数据将以Excel格式保存

5. AI分析（更新）
   - 切换到"AI分析"标签页
   - 输入DeepSeek API Key并验证
   - 确保已采集评论数据
   - 选择分析方式：
     * 点击"开始AI分析"进行全面分析
     * 或在问题输入框中输入具体问题
     * 点击"向AI提问"获取针对性回答
   - 等待分析结果生成

## ⚠️ 注意事项

1. Cookie有效期
   - Cookie可能会定期失效，需要重新导入
   - 软件会自动检测Cookie状态（每5分钟）
   - Cookie失效时会提示更新

2. 数据采集
   - 采集前会自动验证Cookie有效性
   - 如遇到采集失败，请检查Cookie状态
   - 建议定期更新Cookie以确保稳定性
   - 大量评论采集可能需要较长时间，请耐心等待

3. AI分析
   - 需要有效的DeepSeek API Key
   - 分析前需要先采集评论数据
   - 分析大量评论可能需要较长时间
   - API Key会安全存储在本地

## 🔧 环境要求

- Python 3.8+
- PyQt6
- pandas
- httpx
- requests
- loguru
- openpyxl

## 📦 安装依赖

```bash
pip install -r requirements.txt
```

## 🚀 运行程序

```bash
python gui.py
```

## 📄 开源协议

本项目遵循 MIT 协议开源。

## 🤝 贡献

欢迎提交 Issue 和 Pull Request 来帮助改进这个项目！
